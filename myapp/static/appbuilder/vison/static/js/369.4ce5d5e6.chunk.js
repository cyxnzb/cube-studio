"use strict";(self.webpackChunkvite_ml_platform=self.webpackChunkvite_ml_platform||[]).push([[369],{45117:function(e,n,i){i.d(n,{C:function(){return l},T:function(){return o}});var t=i(16030),o=function(){return(0,t.I0)()},l=t.v9},45062:function(e,n,i){i.r(n),i.d(n,{default:function(){return rn}});var t=i(72791),o=i(59332),l=i(29439),r=i(29093),a=i(18511),s=i(50199),d=i(77291),c=i(70927),u=i(81318),p=i(15853),x=i(45117),m=i(16097);function f(e,n){var i=null;return function(){for(var t=this,o=arguments.length,l=new Array(o),r=0;r<o;r++)l[r]=arguments[r];clearTimeout(i),i=window.setTimeout((function(){return e.apply(t,l)}),n)}}var h=i(40528),g={modalStyles:(0,h.y0)({position:"fixed",width:"100%",height:"100vh",backgroundColor:"rgba(0, 0, 0, .5)",zIndex:999,display:"flex",justifyContent:"center",alignItems:"center"}),cancelIcon:{iconName:"Cancel"},contentStyles:(0,h.ZC)({container:{minWidth:"75%",minHeight:"80%",overflow:"hidden",display:"flex",borderRadius:2,backgroundColor:"#fff",padding:"0 24px"},header:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"10px 0 14px 0"},body:{flex:1,height:0,position:"relative",display:"flex"},footer:{position:"relative",display:"flex",padding:"24px 0",justifyContent:"flex-end"}}),resizeLine:(0,h.y0)({width:8,height:"100%",cursor:"col-resize",background:"#eee",transition:"background 0.2s",margin:"0 15px 0 2px",display:"flex",alignItems:"center",justifyContent:"center",overflow:"hidden"}),resizeLineIconStyles:(0,h.y0)({display:"flex",justifyContent:"center",alignItems:"center",boxSizing:"border-box",paddingRight:"19px",width:8,height:20,fontSize:20,pointerEvents:"none"})},v=i(39230),y=i(80184),b=function(e){var n=(0,x.T)(),i=(0,x.C)(m.ld),f=(0,x.C)(m.PF),h=(0,x.C)(m.lr),b=(0,t.useState)(""),j=(0,l.Z)(b,2),w=j[0],C=j[1],S=(0,t.useState)("100%"),k=(0,l.Z)(S,2),N=k[0],_=k[1],L=(0,t.useState)(!1),Z=(0,l.Z)(L,2),D=Z[0],T=Z[1],I=(0,t.useState)(!1),O=(0,l.Z)(I,2),B=O[0],z=O[1],H=(0,v.$G)(),M=H.t,W=(H.i18n,function(){z(!1),n((0,m.y7)(!1))}),E=function(){T(!1)};return(0,t.useEffect)((function(){C(f)}),[i]),(0,y.jsx)("div",{className:g.modalStyles,style:{display:i?"flex":"none"},children:(0,y.jsxs)(o.K,{className:g.contentStyles.container,children:[(0,y.jsxs)("div",{className:g.contentStyles.header,children:[(0,y.jsx)("span",{children:M("\u7f16\u8f91")}),(0,y.jsx)(r.h,{iconProps:g.cancelIcon,onClick:W})]}),(0,y.jsxs)("div",{className:g.contentStyles.body,onMouseMove:function(e){D&&e.clientX>370&&_(e.clientX-270)},onMouseUp:E,onMouseLeave:E,children:[(0,y.jsx)("div",{style:{height:"100%",width:N},children:(0,y.jsx)(p.ZP,{language:h||"json",theme:"vs",value:w,onChange:function(e){z(!1),C(e)},height:500,options:{renderValidationDecorations:"on",automaticLayout:!0,autoClosingOvertype:"always",cursorStyle:"block",quickSuggestions:!1,scrollBeyondLastLine:!1,snippetSuggestions:"none",minimap:{enabled:!1}}})}),(0,y.jsx)("div",{className:g.resizeLine,onMouseDown:function(){T(!0)},children:(0,y.jsx)(a.J,{iconName:"BulletedListBulletMirrored",className:g.resizeLineIconStyles})}),(0,y.jsx)("div",{style:{flex:1}})]}),(0,y.jsxs)("div",{className:g.contentStyles.footer,children:[B?(0,y.jsx)(s.c,{messageBarType:d.f.error,styles:{root:{position:"absolute",width:"50%",left:0}},isMultiline:!1,children:M("\u683c\u5f0f\u9519\u8bef")}):null,(0,y.jsx)(c.K,{styles:{root:{marginRight:10}},onClick:function(){"json"!==h||function(e){try{return JSON.parse(e),!0}catch(n){return!1}}(w)?(n((0,m.sW)(w)),n((0,m.y7)(!1))):z(!0)},children:M("\u786e\u8ba4")}),(0,y.jsx)(u.a,{onClick:W,children:M("\u53d6\u6d88")})]})]})})},j=i(48636),w=i(4942),C=i(2692),S=i(97708),k=i(90110),N=i(17504),_=i(53997),L=i(64011),Z=i(42081),D=i(65223),T=i(57217),I=i(1413),O=i(45987),B=i(89097),z=i(90477),H={settingContainer:(0,h.y0)({display:"flex",flexDirection:"column",width:350,position:"absolute",top:0,right:0,bottom:0,height:"auto",backgroundColor:"#fff",borderLeft:"1px solid rgb(234, 234, 234)",boxShadow:"rgb(0 0 0 / 18%) 0px 1.6px 3.6px 0px, rgb(0 0 0 / 22%) 0px 0.3px 0.9px 0px",zIndex:999}),settingHeader:(0,h.y0)({display:"flex",width:"100%",alignItems:"center",justifyContent:"space-between",color:"balck",boxSizing:"border-box",padding:"10px 20px"}),headerTitle:(0,h.y0)({fontSize:20,fontWeight:600,textOverflow:"ellipsis",overflow:"hidden",whiteSpace:"nowrap",color:"black"}),settingContent:(0,h.y0)({flex:"1 1 0%",overflowY:"auto","&::-webkit-scrollbar":{width:4},"&::-webkit-scrollbar-thumb":{minHeight:"15px",border:"6px solid transparent",backgroundClip:"padding-box",backgroundColor:"rgb(200, 200, 200)"}}),contentWrapper:(0,h.y0)({padding:"0 20px 20px",overflowX:"hidden",wordBreak:"break-word",userSelect:"text",borderTop:"1px solid #eaeaea"}),splitLine:(0,h.y0)({margin:"10px -20px 0 -20px",borderTop:"1px solid #eaeaea"})},M=i(27675),W=i(76483),E=(i(42173),i(2924)),F=i(72426),R=i.n(F),P=["regex","onChange","errorMessage","value"];function K(e){var n=e.regex,i=e.onChange,o=e.errorMessage,r=e.value,a=void 0===r?"":r,s=(0,O.Z)(e,P),d=(0,t.useState)(""),c=(0,l.Z)(d,2),u=c[0],p=c[1],x=(0,t.useState)(""),m=(0,l.Z)(x,2),f=m[0],h=m[1];(0,t.useEffect)((function(){p(a)}),[a]);var g=(0,t.useMemo)((function(){return n?"string"===typeof n?new RegExp(n):n:null}),[n]),v=o||f;return(0,y.jsx)(B.n,(0,I.Z)((0,I.Z)({},s),{},{value:u,onChange:function(e,n){var t=n||"";p(t),h(function(e){return g&&e?g.test(e)?"":"\u8f93\u5165\u683c\u5f0f\u4e0d\u6b63\u786e":""}(t)),null===i||void 0===i||i(e,t)},errorMessage:v}))}var G=function(){var e=(0,x.T)(),n=(0,x.C)(j.H6),i=(0,x.C)(D.RU),o=(0,x.C)(j.mg),a=(0,x.C)(Z.hr),s=(0,t.useState)({}),d=(0,l.Z)(s,2),c=d[0],u=d[1],p=(0,t.useState)([]),m=(0,l.Z)(p,2),f=m[0],h=m[1],g=(0,t.useState)(),b=(0,l.Z)(g,2),w=b[0],C=b[1],S=(0,v.$G)(),k=S.t,L=(S.i18n,function(i,t){var l={};if(l[i]=t,"project"===i){var r=t;C(r),l[i]=r.key}n&&(u((0,I.Z)((0,I.Z)({},c),l)),e((0,j.v_)((0,I.Z)((0,I.Z)({},o),l))))});return(0,t.useEffect)((function(){if(n){var e,i;u(n);var t={key:null===n||void 0===n||null===(e=n.project)||void 0===e?void 0:e.id,text:null===n||void 0===n||null===(i=n.project)||void 0===i?void 0:i.name};C(t)}}),[n]),(0,t.useEffect)((function(){Object.keys(o).length>1&&e((0,j.u6)(!0))}),[o]),(0,t.useEffect)((function(){_.Z.project_modelview().then((function(e){var n=null===e||void 0===e?void 0:e.result.data.reduce((function(e,n){var i={key:n.id,text:n.name};return e.push(i),e}),[]);h(n)}))}),[]),(0,t.useEffect)((function(){var n={};a.forEach((function(e){if((0,N.un)(e)){var i,t=a.filter((function(n){return n.id===e.source}))[0],o=a.filter((function(n){return n.id===e.target}))[0];null!==(i=n["".concat(o.data.name)])&&void 0!==i&&i.upstream?n["".concat(o.data.name)].upstream.push("".concat(t.data.name)):(n["".concat(o.data.name)]={},n["".concat(o.data.name)].upstream=["".concat(t.data.name)])}}));var i=(0,I.Z)({},n);u((0,I.Z)((0,I.Z)({},c),{dag_json:JSON.stringify(i,void 0,4)})),e((0,j.v_)((0,I.Z)((0,I.Z)({},o),{dag_json:JSON.stringify(i)})))}),[a]),(0,y.jsxs)("div",{style:{visibility:i?"visible":"hidden"},className:H.settingContainer,children:[(0,y.jsxs)("div",{className:H.settingHeader,children:[(0,y.jsx)("div",{className:H.headerTitle,children:k("\u6d41\u6c34\u7ebf\u8bbe\u7f6e")}),(0,y.jsx)(r.h,{iconProps:{iconName:"ChromeClose",styles:{root:{fontSize:12,color:"#000"}}},onClick:function(){e((0,D.ZN)())}})]}),(0,y.jsx)("div",{className:H.settingContent,children:(0,y.jsxs)("div",{className:H.contentWrapper,children:[(0,y.jsx)(z.L,{label:k("\u9879\u76ee\u7ec4"),onChange:function(e,n){L("project",n||"")},selectedKey:w?w.key:void 0,placeholder:"Select an option",options:f}),(0,y.jsx)("div",{className:H.splitLine}),(0,y.jsx)(B.n,{label:k("\u540d\u79f0"),description:k("\u82f1\u6587\u540d(\u5b57\u6bcd\u3001\u6570\u5b57\u3001- \u7ec4\u6210)\uff0c\u6700\u957f50\u4e2a\u5b57\u7b26"),onChange:function(e,n){L("name",n||"")},value:(null===c||void 0===c?void 0:c.name)||"",disabled:!0}),(0,y.jsx)("div",{className:H.splitLine}),(0,y.jsx)(B.n,{label:k("\u63cf\u8ff0"),required:!0,onChange:function(e,n){L("describe",n||"")},value:(null===c||void 0===c?void 0:c.describe)||""}),(0,y.jsx)("div",{className:H.splitLine}),(0,y.jsx)(z.L,{label:k("\u8c03\u5ea6\u4f18\u5148\u7ea7"),options:[{key:"high",text:"high"},{key:"low",text:"low"}],selectedKey:(null===c||void 0===c?void 0:c.priority)||"high",onChange:function(e,n){L("priority","".concat(null===n||void 0===n?void 0:n.text)||"")},disabled:!0}),(0,y.jsx)("div",{className:H.splitLine}),(0,y.jsx)(z.L,{label:k("\u8c03\u5ea6\u7c7b\u578b"),options:[{key:"once",text:"once"},{key:"crontab",text:"crontab"}],selectedKey:null===c||void 0===c?void 0:c.schedule_type,onChange:function(e,n){L("schedule_type","".concat(null===n||void 0===n?void 0:n.text)||"")}}),(0,y.jsx)("div",{className:H.splitLine}),(0,y.jsx)(K,{label:k("\u8c03\u5ea6\u5468\u671f"),regex:/^(\s*([*0-9,-/]+)\s+){4}([*0-9,-/]+)\s*$/,description:k("\u5468\u671f\u4efb\u52a1\u7684\u65f6\u95f4\u8bbe\u5b9a\u6309\u7167crontab\u4e66\u5199\u683c\u5f0f"),onChange:function(e,n){L("cron_time",n||"")},value:(null===c||void 0===c?void 0:c.cron_time)||""}),(0,y.jsx)("div",{className:H.splitLine}),(0,y.jsx)("div",{style:{fontWeight:600,padding:"5px 0px"},children:k("\u76d1\u63a7\u72b6\u6001")}),(0,y.jsx)(M.Z,{style:{width:"100%",border:"1px solid rgb(55, 55, 55)"},value:null!==c&&void 0!==c&&c.alert_status?((null===c||void 0===c?void 0:c.alert_status)||"").split(","):void 0,onChange:function(e){L("alert_status",(e||[]).join(","))},mode:"multiple",options:[{label:"Created",value:"Created"},{label:"Pending",value:"Pending"},{label:"Running",value:"Running"},{label:"Succeeded",value:"Succeeded"},{label:"Failed",value:"Failed"},{label:"Unknown",value:"Unknown"},{label:"Waiting",value:"Waiting"},{label:"Terminated",value:"Terminated"}]}),(0,y.jsx)("div",{className:H.splitLine}),(0,y.jsx)(B.n,{label:k("\u62a5\u8b66\u4eba"),description:k("\u6bcf\u4e2a\u7528\u6237\u4f7f\u7528\u82f1\u6587\u9017\u53f7\u5206\u9694"),onChange:function(e,n){L("alert_user",n||"")},value:(null===c||void 0===c?void 0:c.alert_user)||""}),(0,y.jsx)("div",{className:H.splitLine}),(0,y.jsx)("div",{style:{fontWeight:600,padding:"5px 0px"},children:k("\u8865\u5f55\u8d77\u70b9")}),(0,y.jsx)(W.Z,{style:{width:"100%",border:"1px solid rgb(55, 55, 55)"},locale:E.Z,showTime:!0,value:null!==c&&void 0!==c&&c.cronjob_start_time?R()(null===c||void 0===c?void 0:c.cronjob_start_time):void 0,onChange:function(e,n){L("cronjob_start_time",n)},disabledDate:function(e){return e&&e>R()().endOf("day")}}),(0,y.jsx)("div",{className:H.splitLine}),(0,y.jsx)(z.L,{label:k("\u8fc7\u5f80\u4f9d\u8d56"),options:[{key:"true",text:k("\u662f"),data:!0},{key:"false",text:k("\u5426"),data:!1}],selectedKey:"".concat(c.depends_on_past),onChange:function(e,n){L("depends_on_past",null===n||void 0===n?void 0:n.data)}}),(0,y.jsx)("div",{className:H.splitLine}),(0,y.jsx)(B.n,{label:k("\u6700\u5927\u6fc0\u6d3b\u8fd0\u884c\u6570"),description:k("\u5f53\u524dpipeline\u53ef\u540c\u65f6\u8fd0\u884c\u7684\u4efb\u52a1\u6d41\u5b9e\u4f8b\u6570\u76ee"),onChange:function(e,n){L("max_active_runs",n?+n:"")},value:(null===c||void 0===c?void 0:c.max_active_runs)||"",required:!0}),(0,y.jsx)("div",{className:H.splitLine}),(0,y.jsx)(B.n,{label:k("\u4fdd\u7559\u5b9e\u4f8b\u6570\u76ee"),description:k("\u5b9a\u65f6\u8c03\u5ea6\u53ea\u4fdd\u7559\u6700\u65b0\u7684n\u6b21\u5b9e\u4f8b\u8fd0\u884c\uff0c0\u8868\u793a\u4e0d\u9650\u5236"),onChange:function(e,n){L("expired_limit",n?+n:"0")},value:(null===c||void 0===c?void 0:c.expired_limit)||"0"}),(0,y.jsx)("div",{className:H.splitLine}),(0,y.jsx)(B.n,{label:k("\u4efb\u52a1\u5e76\u884c\u6570"),description:k("pipeline\u4e2d\u53ef\u540c\u65f6\u8fd0\u884c\u7684task\u6570\u76ee"),onChange:function(e,n){L("parallelism",n?+n:"")},value:(null===c||void 0===c?void 0:c.parallelism)||"",required:!0}),(0,y.jsx)("div",{className:H.splitLine}),(0,y.jsx)(B.n,{label:k("\u6d41\u5411\u56fe"),onChange:function(e,n){L("dag_json",n||"{}")},value:(null===c||void 0===c?void 0:c.dag_json)||"{}",multiline:!0,autoAdjustHeight:!0,disabled:!0}),(0,y.jsx)("div",{className:H.splitLine}),(0,y.jsx)(B.n,{label:k("\u5168\u5c40\u73af\u5883\u53d8\u91cf"),description:k("\u4e3a\u6bcf\u4e2atask\u90fd\u6dfb\u52a0\u7684\u516c\u5171\u53c2\u6570"),onChange:function(e,n){L("global_env",n||"")},multiline:!0,autoAdjustHeight:!0,value:(null===c||void 0===c?void 0:c.global_env)||""})]})})]})},A=i(25443),J=i(93433),$=i(97776),U=i(95141),X=i(67808),q=i(67422),V=i(81830),Y=i(54794),Q=i(63934),ee={modelContainer:(0,h.y0)({display:"flex",flexDirection:"column",width:350,position:"absolute",top:0,right:0,bottom:0,height:"auto",backgroundColor:"#fff",borderLeft:"1px solid rgb(234, 234, 234)",boxShadow:"rgb(0 0 0 / 18%) 0px 1.6px 3.6px 0px, rgb(0 0 0 / 22%) 0px 0.3px 0.9px 0px",zIndex:998}),modelHeader:(0,h.y0)({display:"flex",width:"100%",alignItems:"center",justifyContent:"space-between",color:"balck",boxSizing:"border-box",padding:"10px 20px"}),headerTitle:(0,h.y0)({fontSize:20,textOverflow:"ellipsis",overflow:"hidden",whiteSpace:"nowrap",color:"black",fontWeight:600}),modelContent:(0,h.y0)({flex:"1 1 0%",overflowY:"auto","&::-webkit-scrollbar":{width:4},"&::-webkit-scrollbar-thumb":{minHeight:"15px",border:"6px solid transparent",backgroundClip:"padding-box",backgroundColor:"rgb(200, 200, 200)"}}),contentWrapper:(0,h.y0)({padding:"0 20px 20px",overflowX:"hidden",wordBreak:"break-word",userSelect:"text",borderTop:"1px solid #eaeaea"}),splitLine:(0,h.y0)({margin:"10px -20px 0 -20px",borderTop:"1px solid #eaeaea"}),settingControl:(0,h.y0)({height:"auto",display:"flex",flexDirection:"column",paddingTop:20}),saveButton:(0,h.y0)({alignSelf:"center"}),debugButton:(0,h.y0)({display:"flex",flexDirection:"row",justifyContent:"space-evenly",paddingTop:20}),templateConfig:(0,h.y0)({color:"rgb(96, 94, 92)",fontSize:10,paddingTop:5,paddingLeft:2,"> a":{textDecoration:"none"}}),argsDescription:(0,h.y0)({color:"rgb(96, 94, 92)",fontSize:10,"> a":{textDecoration:"none"}}),textLabelStyle:(0,h.y0)({display:"flex",alignItems:"center",justifyContent:"space-between",fontWeight:600,color:"rgb(50, 49, 48)",boxSizing:"border-box",boxShadow:"none",margin:"0px",padding:"5px 0px",overflowWrap:"break-word",lineHeight:"30px"}),tipStyle:(0,h.y0)({maxWidth:"500px !important",maxHeight:"400px",overflowY:"auto"})},ne=i(6401),ie=i(99917),te=i(73712),oe=(i.p,["regex","onChange","errorMessage","value"]);function le(e){var n=e.regex,i=e.onChange,o=e.errorMessage,r=e.value,a=void 0===r?"":r,s=(0,O.Z)(e,oe),d=(0,t.useState)(""),c=(0,l.Z)(d,2),u=c[0],p=c[1],x=(0,t.useState)(""),m=(0,l.Z)(x,2),f=m[0],h=m[1];(0,t.useEffect)((function(){p(a)}),[a]);var g=(0,t.useMemo)((function(){return n?"string"===typeof n?new RegExp(n):n:null}),[n]),v=o||f;return(0,y.jsx)(B.n,(0,I.Z)((0,I.Z)({},s),{},{value:u,onChange:function(e,n){var t=n||"";p(t),h(function(e){return g&&e?g.test(e)?"":"\u8f93\u5165\u683c\u5f0f\u4e0d\u6b63\u786e":""}(t)),null===i||void 0===i||i(e,t)},errorMessage:v}))}var re=function(e){var n=(0,x.T)(),i=(0,x.C)(Z.hr),o=(0,x.C)(T.Aj),r=(0,x.C)(m.ld),a=(0,x.C)(m.OA),s=(0,x.C)(m.PF),d=(0,t.useState)({}),c=(0,l.Z)(d,2),u=c[0],p=c[1],f=(0,t.useState)({}),h=(0,l.Z)(f,2),g=h[0],b=h[1],j=(0,t.useState)({}),w=(0,l.Z)(j,2),C=w[0],S=w[1],k=(0,t.useState)({}),N=(0,l.Z)(k,2),D=N[0],O=N[1],H=(0,t.useState)({}),M=(0,l.Z)(H,2),W=M[0],E=M[1],F=(0,v.$G)(),R=F.t,P=(F.i18n,(0,t.useState)("clear")),K=(0,l.Z)(P,2),G=K[0],A=K[1],oe=[{key:"debug",text:"debug",onClick:function(){return re("debug")},iconProps:{iconName:"Bug"}},{key:"run",text:"run",onClick:function(){return re("run")},iconProps:{iconName:"Play"}},{key:"log",text:"log",onClick:function(){return re("log")},iconProps:{iconName:"TimeEntry"}},{key:"clear",text:G||"clear",onClick:function(){return ae("clear")},iconProps:{iconName:"Unsubscribe"}}],re=function(n){A("clear"),e.model.id&&window.open("".concat(window.location.origin,"/task_modelview/api/").concat(n,"/").concat(e.model.id))},ae=function(n){e.model.id&&(A("cleaning"),_.Z.task_modelview_clear(e.model.id).then((function(e){A("cleared")})))},se=function(e,n,i){var t={},o=null;switch(i){case"json":try{o=JSON.parse("".concat(n))}catch(r){o=n}break;case"int":case"float":o=+n;break;default:o=n}if(i){var l=JSON.parse(JSON.stringify(W));l[e]=o,t.args=JSON.stringify(l)}else t[e]=n;b((0,I.Z)((0,I.Z)({},g),t)),p((0,I.Z)((0,I.Z)({},u),t)),null!==t&&void 0!==t&&t.args&&E((0,I.Z)((0,I.Z)({},W),JSON.parse(t.args)))};return(0,t.useEffect)((function(){e.model.selected&&(n((0,T.kQ)(+e.model.id)),0===Object.keys(u).length&&_.Z.task_modelview_get(+e.model.id).then((function(e){if(0===e.status){var n=JSON.parse(e.result.args),i=e.result.job_template,t=null!==i&&void 0!==i&&i.args?JSON.parse(i.args):{},o=Object.keys(t).reduce((function(e,n){var i=t[n];return Object.keys(i).forEach((function(n){e[n]=i[n].default})),e}),{});p(e.result),E(Object.assign(o,n)),O(t),S(i)}})).catch((function(e){e.response&&n((0,L.L$)({msg:e.response.data.message}))})))}),[e.model.selected]),(0,t.useEffect)((function(){if(e.model.id&&n((0,T.hs)({id:+e.model.id,changed:g})),null!==g&&void 0!==g&&g.label){var t=i.map((function(n){if(n.id===e.model.id){var i=(0,I.Z)((0,I.Z)({},n.data),{label:g.label});return(0,I.Z)((0,I.Z)({},n),{data:i})}return n}));n((0,Z.OV)(t))}}),[g]),(0,t.useEffect)((function(){Object.keys(D).length>0&&+e.model.id===o&&!r&&se(a,s,"json")}),[s]),(0,y.jsxs)("div",{className:ee.modelContainer,style:{visibility:e.model.selected?"visible":"hidden"},children:[(0,y.jsx)("div",{className:ee.modelHeader,children:(0,y.jsx)("div",{className:ee.headerTitle,children:(null===u||void 0===u?void 0:u.name)||""})}),(0,y.jsx)("div",{className:ee.modelContent,children:(0,y.jsxs)("div",{className:ee.contentWrapper,children:[(0,y.jsx)($.X,{items:oe,overflowItems:[],styles:{root:{padding:0}}}),(0,y.jsx)(B.n,{label:R("\u4efb\u52a1\u6a21\u677f"),value:(null===C||void 0===C?void 0:C.name)||"",disabled:!0,readOnly:!0,onRenderDescription:function(){var e="";try{var n;if(C.expand)e=(null===(n=JSON.parse(C.expand))||void 0===n?void 0:n.help_url)||""}catch(i){console.error(i)}return(0,y.jsx)("div",{className:ee.templateConfig,children:e?(0,y.jsx)("a",{href:e,target:"_blank",rel:"noreferrer",children:R("\u914d\u7f6e\u6587\u6863")}):null})}}),(0,y.jsx)("div",{className:ee.splitLine}),(0,y.jsx)(ne.Z,{title:(null===C||void 0===C?void 0:C.describe)||"",className:"mr8",placement:"bottom",children:(0,y.jsx)("span",{children:(0,y.jsx)(B.n,{label:R("\u6a21\u677f\u63cf\u8ff0"),value:(null===C||void 0===C?void 0:C.describe)||"",disabled:!0,readOnly:!0,style:{pointerEvents:"none"}})})}),(0,y.jsx)("div",{className:ee.splitLine}),(0,y.jsx)(B.n,{label:R("\u540d\u79f0"),onChange:function(e,n){se("name",n||"")},value:(null===u||void 0===u?void 0:u.name)||"",disabled:!0}),(0,y.jsx)("div",{className:ee.splitLine}),(0,y.jsx)(B.n,{label:R("\u6807\u7b7e"),description:R("\u8282\u70b9\u6807\u7b7e"),required:!0,onChange:function(e,n){se("label",n||"")},value:(null===u||void 0===u?void 0:u.label)||""}),(0,y.jsx)("div",{className:ee.splitLine}),(0,y.jsx)(le,{label:R("\u5185\u5b58\u7533\u8bf7"),regex:/^[0-9]*G$/,description:R("\u5185\u5b58\u7684\u8d44\u6e90\u4f7f\u7528\u914d\u7f6e\uff0c\u793a\u4f8b1G\uff0c10G\uff0c \u6700\u5927100G\uff0c\u5982\u9700\u66f4\u591a\u8054\u7cfb\u7ba1\u7406\u5458"),onChange:function(e,n){se("resource_memory",n||"")},value:(null===u||void 0===u?void 0:u.resource_memory)||"",required:!0}),(0,y.jsx)("div",{className:ee.splitLine}),(0,y.jsx)(le,{label:R("CPU\u7533\u8bf7"),regex:/^[0-9]*$/,description:R("CPU\u7684\u8d44\u6e90\u4f7f\u7528\u914d\u7f6e(\u5355\u4f4d\u6838)\uff0c\u793a\u4f8b 0.4\uff0c10\uff0c\u6700\u592750\u6838\uff0c\u5982\u9700\u66f4\u591a\u8054\u7cfb\u7ba1\u7406\u5458"),onChange:function(e,n){se("resource_cpu",n||"")},value:(null===u||void 0===u?void 0:u.resource_cpu)||"",required:!0}),(0,y.jsx)("div",{className:ee.splitLine}),(0,y.jsx)(le,{label:R("GPU\u7533\u8bf7"),regex:/^[\-\.0-9,a-zA-Z\(\)]*$/,description:R("gpu\u7684\u8d44\u6e90\u4f7f\u7528\u914d\u7f6e(\u5355\u4f4d\u5361)\uff0c\u793a\u4f8b:1\uff0c2\uff0c\u8bad\u7ec3\u4efb\u52a1\u6bcf\u4e2a\u5bb9\u5668\u72ec\u5360\u6574\u5361\u3002\u7533\u8bf7\u5177\u4f53\u7684\u5361\u578b\u53f7\uff0c\u53ef\u4ee5\u7c7b\u4f3c 1(V100)"),onChange:function(e,n){se("resource_gpu",n||"")},value:(null===u||void 0===u?void 0:u.resource_gpu)||""}),(0,y.jsx)("div",{className:ee.splitLine}),(0,y.jsx)(le,{label:R("RDMA\u7533\u8bf7"),regex:/^[0-9]*$/,description:R("RDMA\u7684\u8d44\u6e90\u4f7f\u7528\u914d\u7f6e\uff0c\u793a\u4f8b 0\uff0c1\uff0c10\uff0c\u586b\u5199\u65b9\u5f0f\u54a8\u8be2\u7ba1\u7406\u5458"),onChange:function(e,n){se("resource_rdma",n||"")},value:(null===u||void 0===u?void 0:u.resource_rdma)||"",required:!0}),(0,y.jsx)("div",{className:ee.splitLine}),(0,y.jsx)(le,{label:R("\u8d85\u65f6\u4e2d\u65ad"),regex:/^[0-9]*$/,description:R("task\u8fd0\u884c\u65f6\u957f\u9650\u5236\uff0c\u4e3a0\u8868\u793a\u4e0d\u9650\u5236(\u5355\u4f4ds)"),onChange:function(e,n){se("timeout",n||"")},value:(null===u||void 0===u?void 0:u.timeout)||0}),(0,y.jsx)("div",{className:ee.splitLine}),(0,y.jsx)(le,{label:R("\u91cd\u8bd5\u6b21\u6570"),regex:/^[0-9]*$/,description:R("task\u91cd\u8bd5\u6b21\u6570"),onChange:function(e,n){se("retry",n||"")},value:(null===u||void 0===u?void 0:u.retry)||0}),(0,y.jsx)("div",{className:ee.splitLine}),(0,y.jsx)("div",{style:{fontWeight:600,padding:"5px 0px"},children:R("\u662f\u5426\u8df3\u8fc7")}),(0,y.jsx)(ie.Z,{checkedChildren:R("\u662f"),unCheckedChildren:R("\u5426"),checked:!(null===u||void 0===u||!u.skip),onChange:function(e){se("skip",e)}}),Object.keys(D).reduce((function(e,i){var o=D[i],l=Object.keys(o).map((function(e){var i=o[e],l=(0,te.TU)(i.tip||"",{async:!1}),r=(0,y.jsx)(ne.Z,{overlayClassName:ee.tipStyle,title:(0,y.jsx)("span",{className:"cube-tip",dangerouslySetInnerHTML:{__html:l}}),children:(0,y.jsx)("span",{style:{fontWeight:"bold",color:"#0078d4",marginLeft:"10px"},children:R("\u8be6\u60c5")})}),a=i.choice,s=[];Array.isArray(a)?s=a.map((function(e){return{key:e,text:e}})):"object"===typeof a&&null!==a&&(s=Object.keys(a).map((function(e){return{key:e,text:a[e]}}))),console.log(s);var d=W&&W[e],c="json"===i.type?JSON.stringify(d,void 0,4):d;if("float"===i.type){var u="string"===typeof i.range?i.range.split(","):i.range;return(0,y.jsx)(t.Fragment,{children:(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)(U.i,{styles:{valueLabel:{margin:"0",width:"auto"}},label:"".concat(e),min:u[0]||0,max:u[1]||1,step:i.step||.1,onChange:function(n){se(e,n||0,i.type)},value:c,disabled:1!==i.editable,showValue:!0}),(0,y.jsxs)("div",{className:ee.argsDescription,children:[(0,y.jsx)("span",{dangerouslySetInnerHTML:{__html:i.describe}}),i.tip?r:null]})]})},e)}if("int"===i.type){var p="string"===typeof i.range?i.range.split(","):i.range;return(0,y.jsx)(t.Fragment,{children:(0,y.jsxs)("div",{style:{width:"100%"},children:[(0,y.jsx)(X.k,{styles:{root:{display:"flex",flexDirection:"column",alignItems:"flex-start",width:"100%"},spinButtonWrapper:{width:"100%"},labelWrapper:{marginBottom:"4px"}},label:"".concat(e),min:p||0,max:p||100,step:i.step||1,onIncrement:function(n){se(e,n?parseInt(n,10)+1:1,i.type)},onDecrement:function(n){se(e,n?parseInt(n,10)-1:-1,i.type)},value:c,disabled:1!==i.editable}),(0,y.jsxs)("div",{className:ee.argsDescription,children:[(0,y.jsx)("span",{dangerouslySetInnerHTML:{__html:i.describe}}),i.tip?r:null]})]})},e)}if("bool"===i.type)return(0,y.jsx)(t.Fragment,{children:(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)(q.Z,{label:"".concat(e),checked:c,onChange:function(n,t){se(e,t||!1,i.type)},onText:"On",offText:"Off",disabled:1!==i.editable}),(0,y.jsxs)("div",{className:ee.argsDescription,children:[(0,y.jsx)("span",{dangerouslySetInnerHTML:{__html:i.describe}}),i.tip?r:null]})]})},e);if("list"===i.type){var x=("string"===typeof c?c:i.default).split(",");return(0,y.jsx)(t.Fragment,{children:(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)(z.L,{label:"".concat(e),onChange:function(n,t){var o,l=("string"===typeof c?c:i.default).split(","),r=l=l.filter((function(e){return""!==e.trim()}));null!==t&&void 0!==t&&t.selected?l.includes(t.key)||(r=[].concat((0,J.Z)(l),[t.key])):r=l.filter((function(e){return e!==(null===t||void 0===t?void 0:t.key)}));var a=null===(o=r)||void 0===o?void 0:o.join(",");se(e,a||"",i.type)},selectedKeys:x,options:s,required:1===i.require,disabled:1!==i.editable,multiSelect:!0}),(0,y.jsxs)("div",{className:ee.argsDescription,children:[(0,y.jsx)("span",{dangerouslySetInnerHTML:{__html:i.describe}}),i.tip?r:null]})]})},e)}return s.length>0&&"select-input"===i.item_type?(0,y.jsx)(t.Fragment,{children:(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)(V.C,{label:"".concat(e),onChange:function(n,t,o,l){var r=void 0!==l?l:t?t.text:"";void 0!==r&&se(e,r,i.type)},onBlur:function(n){var t=n.target.value;void 0!==t&&se(e,t,i.type)},selectedKey:c||i.default,text:c||i.default,options:s,allowFreeform:!0,autoComplete:"on",openOnKeyboardFocus:!0,required:1===i.require,disabled:1!==i.editable,styles:{root:{width:"100%"},callout:{width:"300px",minWidth:"unset"},optionsContainer:{width:"100%"}}}),(0,y.jsxs)("div",{className:ee.argsDescription,children:[(0,y.jsx)("span",{dangerouslySetInnerHTML:{__html:i.describe}}),i.tip?r:null]})]})},e):s.length>0?(0,y.jsx)(t.Fragment,{children:(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)(z.L,{label:"".concat(e),onChange:function(n,t){se(e,"".concat(null===t||void 0===t?void 0:t.key)||"",i.type)},defaultSelectedKey:c||i.default,options:s,required:1===i.require,disabled:1!==i.editable}),(0,y.jsxs)("div",{className:ee.argsDescription,children:[(0,y.jsx)("span",{dangerouslySetInnerHTML:{__html:i.describe}}),i.tip?r:null]})]})},e):(0,y.jsx)(t.Fragment,{children:(0,y.jsx)(y.Fragment,{children:(0,y.jsx)(le,{onRenderLabel:function(){return(0,y.jsxs)("div",{className:ee.textLabelStyle,children:["".concat(e),"json"===i.type||"text"===i.type?(0,y.jsx)(Y.K,{iconProps:{iconName:"FullWidthEdit"},onClick:function(){n((0,m.vh)({key:e,value:c,type:"json"===i.type?"json":i.item_type||"str"})),n((0,m.y7)(!0))},children:R("\u7f16\u8f91")}):"workdir"===(i.item_type||"str")?(0,y.jsx)(Y.K,{iconProps:{iconName:"FabricFolder"},onClick:function(){window.open("/notebook_modelview/api/entry/jupyter?file_path="+c,"_blank")},children:R("\u6253\u5f00\u76ee\u5f55")}):"image"===(i.item_type||"str")?(0,y.jsx)(Y.K,{iconProps:{iconName:"Bug"},onClick:function(){window.open("/docker_modelview/api/entry/docker?image="+c,"_blank")},children:R("\u8c03\u8bd5\u955c\u50cf")}):null]})},onRenderDescription:function(){return(0,y.jsxs)("div",{className:ee.argsDescription,children:[(0,y.jsx)("span",{dangerouslySetInnerHTML:{__html:i.describe}}),i.tip?r:null]})},multiline:"json"===i.type||"text"===i.type,autoAdjustHeight:"json"===i.type||"text"===i.type,onChange:function(n,t){se(e,t||"",i.type)},value:c,required:1===i.require,regex:i.regex,disabled:1!==i.editable||"json"===i.type})})},e)}));return e.push((0,y.jsxs)(t.Fragment,{children:[(0,y.jsxs)(Q._,{children:[R("\u53c2\u6570")," ",i]}),l.flat(),(0,y.jsx)("div",{className:ee.splitLine})]},i)),e}),[])]})})]})},ae={height:54,minWidth:272,borderRadius:100,borderStyle:"solid",display:"flex",flexDirection:"row",backgroundColor:"#fff",fontSize:12,cursor:"move",boxSizing:"border-box",transition:"all 0.3s"},se=(0,h.y0)((0,I.Z)((0,I.Z)({},ae),{borderWidth:1,borderColor:"#b1b1b7"})),de=(0,h.y0)((0,I.Z)((0,I.Z)({},ae),{borderWidth:1,borderColor:"#006dce",backgroundColor:"#f1f7fd"})),ce=(0,h.y0)({width:8,flexShrink:0,borderRadius:"3px 0 0 3px",borderRight:"1px solid #8a8886",margin:"-8px 0 -8px -8px"}),ue=(0,h.y0)({boxSizing:"border-box",display:"flex",flexDirection:"column",overflow:"hidden"}),pe=(0,h.y0)({display:"flex",marginLeft:7,minHeight:26}),xe=(0,h.y0)({fontSize:16,width:64,display:"flex",alignItems:"center",justifyContent:"center",backgroundColor:"rgb(0, 120, 212)",borderTopLeftRadius:100,borderBottomLeftRadius:100,margin:"-1px 0 -1px -1px"}),me=(0,h.y0)({userSelect:"none",boxSizing:"border-box",color:"#fff",fontSize:20,marginLeft:8}),fe=(0,h.y0)({whiteSpace:"nowrap",textOverflow:"ellipsis",overflow:"hidden",paddingLeft:8,paddingBottom:2,marginBottom:2,fontWeight:600,fontSize:14,borderBottom:"1px dashed #c1c1c1",userSelect:"none"}),he=(0,h.y0)({width:"12px !important",height:"12px !important",bottom:"-7px !important",borderColor:"#b1b1b7 !important",backgroundColor:"#fff !important",transition:"all 0.3s","&:hover":{borderWidth:"2px !important",borderColor:"var(--hover-color) !important",cursor:"pointer !important"}}),ge=(0,h.y0)({visibility:"hidden"}),ve=(0,h.y0)({height:"100%",width:"100%",display:"flex",justifyContent:"center",flexDirection:"column"}),ye={nodeTips:(0,h.y0)({color:"rgb(177, 177, 183)",paddingLeft:8,maxWidth:"250px",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"}),nodeContentWrapper:ve,nodeContainer:se,nodeOnSelect:de,nodeBar:ce,nodeContent:ue,nodeConentTitleBar:pe,nodeIconWrapper:xe,nodeIcon:me,nodeTitle:fe,handleStyle:he,hidden:ge},be=i(81065),je=i(15669),we=i(91115),Ce=i(25303),Se={get:function(e){var n=window.localStorage.getItem(e);return n&&n.match(/^(\{|\[).*(?=[}\]])/)?JSON.parse(n):n||""},set:function(e,n){window.localStorage.setItem(e,"string"===typeof n?n:JSON.stringify(n))}},ke={dataSet:function(e){var n,i,o,r,s,d,c,u,p,m,f,h,g=(0,t.useState)(!1),b=(0,l.Z)(g,2),C=b[0],S=b[1],k=(0,t.useState)([]),D=(0,l.Z)(k,2),O=D[0],B=D[1],z=(0,t.useState)(),H=(0,l.Z)(z,2),M=H[0],W=H[1],E=(Se.get("job_template").value||[]).reduce((function(e,n){return(0,I.Z)((0,I.Z)({},e),{},(0,w.Z)({},n.name,n))}),{}),F=(0,x.C)(j.Bn),R=(0,x.C)(Z.hr),P=(0,x.T)(),K=(0,v.$G)(),G=K.t;K.i18n;return(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)(be.Z,{title:G("\u667a\u80fd\u63a8\u8350\u4e0b\u6e38\u8282\u70b9"),visible:C,onCancel:function(){W(void 0),S(!1)},onOk:function(){if(M){var n=E[M],i=JSON.parse(n.args),t={};Object.keys(i).reduce((function(e,n){var t={};return Object.keys(i[n]).reduce((function(e,t){var o=i[n][t].default;return Object.assign(e,(0,w.Z)({},t,o)),e}),t),Object.assign(e,t),e}),t);var o={x:e.xPos||0,y:+((null===e||void 0===e?void 0:e.yPos)||0)+100};if(F){P((0,T.Xt)(!0));var l="".concat(n.name.replace(/\.|[\u4e00-\u9fa5]/g,"").replace(/_|\s/g,"-")||"task","-").concat(Date.now()).substring(0,49);_.Z.task_modelview_add(F,{job_template:n.id,pipeline:+F,name:l,label:"".concat(G("\u65b0\u5efa")," ").concat(n.name," ").concat(G("\u4efb\u52a1")),volume_mount:"kubeflow-user-workspace(pvc):/mnt",image_pull_policy:"Always",working_dir:"",command:"",overwrite_entrypoint:0,node_selector:"cpu=true,train=true",resource_memory:"2G",resource_cpu:"2",resource_gpu:"0",resource_rdma:"0",timeout:0,retry:0,args:JSON.stringify(t)}).then((function(e){var i;if(null!==e&&void 0!==e&&null!==(i=e.result)&&void 0!==i&&i.id){var t={id:"".concat(e.result.id),type:"dataSet",position:o,data:{info:n,name:l,label:"".concat(G("\u65b0\u5efa")," ").concat(n.name," ").concat(G("\u4efb\u52a1"))}};P((0,j.u6)(!0)),P((0,Z.OV)(R.concat(t))),setTimeout((function(){P((0,j.oL)())}),2e3)}})).catch((function(e){e.response&&P((0,L.L$)({msg:e.response.data.message}))})).finally((function(){P((0,T.Xt)(!1)),S(!1)}))}}else je.ZP.warn(G("\u8bf7\u5148\u9009\u62e9\u63a8\u8350\u8282\u70b9"))},children:(0,y.jsx)("div",{children:(0,y.jsx)(we.ZP.Group,{onChange:function(e){W(e.target.value)},value:M,children:(0,y.jsx)(Ce.Z,{direction:"vertical",children:O.map((function(e){return(0,y.jsx)(we.ZP,{value:e.name,children:e.name},"recommend_".concat(e.name))}))})})})}),(0,y.jsx)(N.HH,{type:"target",position:N.Ly.Top,className:ye.handleStyle}),(0,y.jsxs)("div",{className:e.selected?ye.nodeOnSelect:ye.nodeContainer,style:{borderColor:e.selected?null===e||void 0===e||null===(n=e.data)||void 0===n||null===(i=n.info)||void 0===i||null===(o=i.color)||void 0===o?void 0:o.color:"",backgroundColor:e.selected?null===e||void 0===e||null===(r=e.data)||void 0===r||null===(s=r.info)||void 0===s||null===(d=s.color)||void 0===d?void 0:d.bg:""},children:[(0,y.jsx)("div",{className:ye.nodeIconWrapper,style:{backgroundColor:null===e||void 0===e||null===(c=e.data)||void 0===c||null===(u=c.info)||void 0===u||null===(p=u.color)||void 0===p?void 0:p.color},children:(0,y.jsx)(a.J,{iconName:"Database",className:ye.nodeIcon})}),(0,y.jsxs)("div",{className:ye.nodeContentWrapper,children:[(0,y.jsx)("div",{className:ye.nodeTitle,children:null===e||void 0===e||null===(m=e.data)||void 0===m?void 0:m.label}),null!==e&&void 0!==e&&null!==(f=e.data)&&void 0!==f&&f.info?(0,y.jsx)("div",{className:ye.nodeTips,children:null===e||void 0===e||null===(h=e.data)||void 0===h?void 0:h.info.describe}):null]})]}),(0,y.jsx)(N.HH,{type:"source",onClick:function(){var n,i;console.log("props",e);var t,o,l=null===(n=e.data)||void 0===n||null===(i=n.info)||void 0===i?void 0:i.expand;"[object String]"===Object.prototype.toString.call(l)&&(l=JSON.parse((null===(t=e.data)||void 0===t||null===(o=t.info)||void 0===o?void 0:o.expand)||"{}"));var r=l.rec_job_template;r&&(B([E[r]]),S(!0))},position:N.Ly.Bottom,className:ye.handleStyle}),(0,y.jsx)(A.m,{hostId:"hostId_model",className:"data-set-layer",children:(0,y.jsx)(re,{model:e})})]})}},Ne={itemStyles:(0,h.y0)({position:"relative"}),flowWrapper:(0,h.y0)({width:"100%",height:"100%"}),spinnerWrapper:(0,h.y0)({position:"absolute",top:0,left:0,display:"flex",justifyContent:"center",alignItems:"center",width:"100%",height:"100%",overflow:"hidden",backgroundColor:"rgba(255, 255, 255, 0.6)",zIndex:9999})},_e=o.K.Item,Le=function(){var e=(0,x.T)(),n=(0,x.C)(Z.hr),i=(0,x.C)(j.Bn),o=(0,x.C)(j.H6),r=(0,x.C)(D.RU),a=(0,x.C)(T.NH),s=(0,t.useRef)(null),d=(0,t.useState)(null),c=(0,l.Z)(d,2),u=c[0],p=c[1],m=(0,v.$G)(),f=m.t;m.i18n;return(0,t.useEffect)((function(){var n=JSON.parse((null===o||void 0===o?void 0:o.expand)||"[]").map((function(e){return!(0,N.un)(e)||null!==e&&void 0!==e&&e.arrowHeadType?((0,N.UG)(e)&&!e.data.label&&(e.data.label=e.data.name),e):Object.assign(e,{arrowHeadType:"arrow"})}));e((0,Z.OV)(n))}),[o]),(0,y.jsx)(_e,{shrink:!0,grow:1,className:Ne.itemStyles,children:(0,y.jsxs)("div",{className:Ne.flowWrapper,ref:s,children:[(0,y.jsxs)(N.ZP,{elements:n,nodeTypes:ke,snapToGrid:!0,snapGrid:[16,16],defaultZoom:1,onLoad:function(e){p(e)},onDrop:function(t){t.preventDefault();var o=s.current.getBoundingClientRect(),l=JSON.parse(t.dataTransfer.getData("application/reactflow")),r=u.project({x:t.clientX-o.left,y:t.clientY-o.top}),a=l.args,d={};if(Object.keys(a).reduce((function(e,n){var i={};return Object.keys(a[n]).reduce((function(e,i){var t=a[n][i].default;return Object.assign(e,(0,w.Z)({},i,t)),e}),i),Object.assign(e,i),e}),d),i){e((0,T.Xt)(!0));var c="".concat(l.name.replace(/\.|[\u4e00-\u9fa5]/g,"").replace(/_|\s/g,"-")||"task","-").concat(Date.now()).substring(0,49);_.Z.task_modelview_add(i,{job_template:l.id,pipeline:+i,name:c,label:"".concat(f("\u65b0\u5efa")," ").concat(l.name," ").concat(f("\u4efb\u52a1")),volume_mount:"kubeflow-user-workspace(pvc):/mnt",image_pull_policy:"Always",working_dir:"",command:"",overwrite_entrypoint:0,node_selector:"cpu=true,train=true",resource_memory:"2G",resource_cpu:"2",resource_gpu:"0",resource_rdma:"0",timeout:0,retry:0,args:JSON.stringify(d)}).then((function(i){var t;if(null!==i&&void 0!==i&&null!==(t=i.result)&&void 0!==t&&t.id){var o={id:"".concat(i.result.id),type:"dataSet",position:r,data:{info:l,name:c,label:"".concat(f("\u65b0\u5efa")," ").concat(l.name," ").concat(f("\u4efb\u52a1"))}};e((0,j.u6)(!0)),e((0,Z.OV)(n.concat(o))),setTimeout((function(){e((0,j.oL)())}),2e3)}})).catch((function(n){n.response&&e((0,L.L$)({msg:n.response.data.message}))})).finally((function(){e((0,T.Xt)(!1))}))}},onDragOver:function(e){e.preventDefault(),e.dataTransfer.dropEffect="move"},onElementClick:function(n,i){r&&i.data&&e((0,D.ZN)())},onElementsRemove:function(i){i.forEach((function(n){null!==n&&void 0!==n&&n.id&&(0,N.UG)(n)&&_.Z.task_modelview_del(+n.id).then((function(){setTimeout((function(){e((0,j.oL)())}),2e3)})).catch((function(n){n.response&&e((0,L.L$)({msg:n.response.data.message}))}))})),e((0,j.u6)(!0)),e((0,Z.OV)((0,N.d0)(i,n)))},onConnect:function(i){e((0,j.u6)(!0)),e((0,Z.OV)((0,N.Z_)(Object.assign(i,{arrowHeadType:"arrow"}),n)))},onNodeDragStop:function(i,t){e((0,Z.OV)(n.map((function(e){return(null===e||void 0===e?void 0:e.id)===(null===t||void 0===t?void 0:t.id)?t:e})))),e((0,j.u6)(!0))},onSelectionChange:function(n){n&&e((0,Z.pM)(n))},children:[(0,y.jsx)(G,{}),(0,y.jsx)(N.a9,{nodeStrokeColor:"#8a8886",nodeColor:"#c8c8c8"}),(0,y.jsx)(N.ZX,{}),(0,y.jsx)(C.Z,{id:"hostId_model",className:"layer-host"})]}),(0,y.jsx)("div",{className:Ne.spinnerWrapper,style:{visibility:a?"visible":"hidden"},children:(0,y.jsx)(S.$,{size:k.E.large,label:"Loading"})})]})})},Ze=i(74165),De=i(15861),Te=i(93657),Ie=function(){var e=(0,x.T)(),n=(0,x.C)(L.V0);return(0,t.useEffect)((function(){n&&setTimeout((function(){e((0,L.L$)(null))}),3e3)}),[n]),n&&(0,y.jsx)(s.c,{messageBarType:d.f.error,styles:{root:{minHeight:32,width:"80%",margin:"0 auto"}},dismissButtonAriaLabel:"Close",onDismiss:function(){e((0,L.L$)(null))},isMultiline:!1,children:(null===n||void 0===n?void 0:n.msg)||""})},Oe={headStyle:{root:{backgroundColor:"#fff",padding:"10px 16px",borderBottom:"1px solid #dadada"}},headNameStyle:(0,h.y0)({boxSizing:"border-box",marginLeft:"8px",padding:"0 8px",height:"32px",lineHeight:"32px",cursor:"text",marginBottom:"4px",fontSize:"16px",fontWeight:600,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",color:"black"}),buttonItemStyle:{root:{marginRight:"16px"}},hidden:(0,h.y0)({visibility:"hidden"})},Be=o.K.Item,ze=function(){var e=(0,x.T)(),n=(0,x.C)(j.Bn),i=(0,x.C)(j.H6),t=(0,x.C)(L.zr),l=(0,v.$G)(),a=l.t,s=(l.i18n,function(){var i=(0,De.Z)((0,Ze.Z)().mark((function i(){return(0,Ze.Z)().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:if(!n){i.next=9;break}return i.t0=e,i.next=4,(0,T.C)();case 4:return i.t1=i.sent,i.next=7,(0,i.t0)(i.t1);case 7:e((0,j.oL)()),window.open("".concat(window.location.origin,"/pipeline_modelview/api/run_pipeline/").concat(n));case 9:case"end":return i.stop()}}),i)})));return function(){return i.apply(this,arguments)}}()),d=function(){var e=(0,De.Z)((0,Ze.Z)().mark((function e(){return(0,Ze.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n&&window.open("".concat(window.location.origin,"/pipeline_modelview/api/copy_pipeline/").concat(n));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return(0,y.jsx)(Be,{className:"editor-head",children:(0,y.jsxs)(o.K,{horizontal:!0,horizontalAlign:"space-between",verticalAlign:"center",styles:Oe.headStyle,children:[(0,y.jsx)(Be,{grow:1,children:(0,y.jsxs)(o.K,{horizontal:!0,children:[(0,y.jsx)(Be,{children:i.name?(0,y.jsx)("div",{className:Oe.headNameStyle,children:i.describe}):(0,y.jsx)(c.K,{styles:{root:{padding:"17px 16px"}},iconProps:{iconName:"Add",styles:{root:{fontSize:10}}},onClick:function(){_.Z.pipeline_modelview_add({describe:"".concat(a("\u65b0\u5efa\u6d41\u6c34\u7ebf"),"-").concat(Date.now()),name:"".concat(t,"-pipeline-").concat(Date.now()),node_selector:"cpu=true,train=true",schedule_type:"once",image_pull_policy:"Always",parallelism:1,project:7}).then((function(e){var n;0===(null===e||void 0===e?void 0:e.status)&&"success"===(null===e||void 0===e?void 0:e.message)&&(window.location.search="?pipeline_id=".concat(null===e||void 0===e||null===(n=e.result)||void 0===n?void 0:n.id))})).catch((function(n){n.response&&e((0,L.L$)({msg:n.response.data.message}))}))},children:a("\u65b0\u5efa\u6d41\u6c34\u7ebf")})}),(0,y.jsx)(Be,{className:i.name?"":Oe.hidden,children:(0,y.jsx)(Te.G,{content:a("\u8bbe\u7f6e"),children:(0,y.jsx)(r.h,{iconProps:{iconName:"Settings"},onClick:function(){e((0,D.ZN)())}})})}),(0,y.jsx)(Be,{grow:1,align:"center",children:(0,y.jsx)(Ie,{})})]})}),(0,y.jsx)(Be,{className:i.name?"":Oe.hidden,children:(0,y.jsxs)(o.K,{horizontal:!0,children:[(0,y.jsx)(Be,{styles:Oe.buttonItemStyle,children:(0,y.jsx)(c.K,{onClick:s,children:a("\u8fd0\u884c")})}),(0,y.jsx)(Be,{styles:Oe.buttonItemStyle,children:(0,y.jsx)(c.K,{onClick:d,children:a("\u590d\u5236")})})]})})]})})},He=i(51244),Me={editorToolStyle:{root:{display:"flex",flexDirection:"row",backgroundColor:"#fff",padding:"2px 0px",borderBottom:"1px solid #dadada","#authoring-page-toolbar":{flex:1}}},autoSavedTips:(0,h.y0)({paddingRight:20,lineHeight:"1"}),commandBarStyle:{root:{height:"40px",padding:"0px 14px 0px 8px",borderBottom:"none",backgroundColor:"#fff"}},commonButton:{root:{width:"40px",height:"40px",borderRadius:"2px",minWidth:"40px"}},commonIcon:{root:{color:"#015cda",fontSize:18}},toggleStyle:{root:{display:"flex",alignItems:"center",padding:"8px 0px 8px 8px",height:"100%",boxSizing:"border-box",borderLeft:"1px solid rgb(234, 234, 234)",marginLeft:"8px"},container:{display:"inline-flex"}},comboBoxStyle:{container:{borderLeft:"1px solid #eaeaea",marginLeft:"4px",padding:"0px 5px 0px 10px",width:"auto"},root:{backgroundColor:"#ffffff",padding:"0px 20px 0px 4px",selectors:{"&.is-open::after":{borderBottom:"2px solid #015cda"},"&::after":{border:"none",borderBottom:0,borderRadius:"none"},".ms-Button":{width:20},".ms-Icon":{fontSize:8}}},input:{width:35,backgroundColor:"#ffffff"}}},We=o.K.Item,Ee=function(){var e=(0,x.T)(),n=(0,x.C)(Z.hr),i=(0,x.C)(j.N1),l=(0,x.C)(j.H6),r=(0,x.C)(j.Bn),s=(0,x.C)(T.BX),d=(0,x.C)(j.B5),c=(0,x.C)(Z.tT),u=(0,v.$G)(),p=u.t,m=(u.i18n,[{key:"expand",iconProps:{iconName:"Library",styles:Me.commonIcon},text:p("\u5c55\u5f00/\u5173\u95ed\u83dc\u5355"),onClick:function(n){null===n||void 0===n||n.preventDefault(),e((0,He.ZN)())}},{key:"save",iconProps:{iconName:"save",styles:Me.commonIcon},text:p("\u4fdd\u5b58"),onClick:function(){var n=(0,De.Z)((0,Ze.Z)().mark((function n(i){return(0,Ze.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return null===i||void 0===i||i.preventDefault(),n.t0=e,n.next=4,(0,T.C)();case 4:n.t1=n.sent,(0,n.t0)(n.t1),e((0,j.oL)());case 7:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}()},{key:"example",iconProps:{iconName:"FastForward",styles:Me.commonIcon},text:p("\u8c03\u5ea6\u5b9e\u4f8b"),onClick:function(){r&&window.open("".concat(window.location.origin,"/pipeline_modelview/api/web/workflow/").concat(r))}},{key:"log",iconProps:{iconName:"ComplianceAudit",styles:Me.commonIcon},text:p("\u65e5\u5fd7"),onClick:function(){null!==l&&void 0!==l&&l.id&&window.open("".concat(window.location.origin,"/pipeline_modelview/api/web/log/").concat(r))}},{key:"docker",iconProps:{iconName:"WebAppBuilderFragment",styles:Me.commonIcon},text:p("\u5bb9\u5668"),onClick:function(){null!==l&&void 0!==l&&l.name&&window.open("".concat(window.location.origin,"/pipeline_modelview/api/web/pod/").concat(r))}},{key:"timer",iconProps:{iconName:"TimeEntry",styles:Me.commonIcon},text:p("\u5b9a\u65f6\u8bb0\u5f55"),onClick:function(){null!==l&&void 0!==l&&l.name&&window.open("".concat(window.location.origin,"/pipeline_modelview/api/web/runhistory/").concat(r))}},{key:"delete",iconProps:{iconName:"Delete",styles:Me.commonIcon},text:p("\u5220\u9664\u8282\u70b9"),onClick:function(){if((0,N.UG)(c[0])){var i,t=+(null===(i=c[0])||void 0===i?void 0:i.id);_.Z.task_modelview_del(t).then((function(){setTimeout((function(){e((0,j.oL)())}),2e3)})).catch((function(n){n.response&&e((0,L.L$)({msg:n.response.data.message}))}))}e((0,j.u6)(!0)),e((0,Z.OV)((0,N.d0)(c,n)))}},{key:"monitor",iconProps:{iconName:"NetworkTower",styles:Me.commonIcon},text:p("\u76d1\u63a7"),onClick:function(){null!==l&&void 0!==l&&l.id&&window.open("".concat(window.location.origin,"/pipeline_modelview/api/web/monitoring/").concat(r))}}]);return(0,t.useEffect)((function(){s&&s.forEach((function(n){Object.keys(n).length>0&&e((0,j.u6)(!0))}))}),[s]),(0,y.jsxs)(We,{shrink:!0,styles:Me.editorToolStyle,children:[(0,y.jsx)($.X,{id:"authoring-page-toolbar",styles:Me.commandBarStyle,items:m}),(0,y.jsx)(o.K,{horizontal:!0,verticalAlign:"center",className:Me.autoSavedTips,style:{visibility:r?"visible":"hidden"},children:i?(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)(a.J,{iconName:d?"AlertSolid":"SkypeCircleCheck",styles:{root:{color:d?"#e95f39":"#8cb93c",marginRight:5}}}),p(d?"\u672a\u4fdd\u5b58":"\u5df2\u4fdd\u5b58")]}):(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)(S.$,{styles:{root:{marginRight:5}},size:k.E.small}),p("\u4fdd\u5b58\u4e2d")]})})]})},Fe=o.K.Item,Re=function(){var e=(0,x.T)();return(0,t.useEffect)((function(){e((0,j.e4)())}),[]),(0,y.jsx)(Fe,{className:"flow-editor",styles:{root:{flexGrow:1,flexShrink:1,background:"#f4f4f4",overflow:"hidden",display:"flex",flexDirection:"column"}},children:(0,y.jsxs)(o.K,{grow:1,children:[(0,y.jsx)(ze,{}),(0,y.jsx)(Ee,{}),(0,y.jsx)(Le,{})]})})},Pe=i(54039),Ke=i(87023),Ge=i(4026),Ae=i(65260),Je={calloutContent:(0,h.y0)({display:"flex",flexFlow:"column nowrap",width:"360px",height:"auto",boxSizing:"border-box",maxHeight:"inherit",padding:"16px 0px",fontSize:"12px",background:"#fff",borderRadius:"2px"}),moduleDetailItemStyle:(0,h.y0)({fontSize:"12px",padding:"0 16px",overflowX:"visible",overflowY:"hidden"}),moduleDetailTitle:(0,h.y0)({padding:"0px 16px",fontWeight:600,fontSize:"14px",lineHeight:"1",marginTop:"0px",marginBottom:"8px"}),moduleDetailLabel:(0,h.y0)({fontSize:"12px",fontWeight:"bold",lineHeight:"16px",color:"rgb(89, 89, 89)",padding:"0px",margin:"0px 0px 4px"}),moduleDetailBody:(0,h.y0)({lineHeight:"14px",marginBottom:"22px",p:{margin:"0",padding:"0"}}),moduleButton:(0,h.y0)({display:"flex",justifyContent:"center",alignItems:"center"})},$e=o.K.Item,Ue=function(){var e,n=(0,x.T)(),i=(0,x.C)(He.p),t=(0,x.C)(He.b2),l=(0,x.C)(He.H6),r=(0,v.$G)(),a=r.t,s=(r.i18n,function(e){n((0,He.DH)("mouseenter"!==e.type))});return(0,y.jsx)(Ke.U,{gapSpace:-10,hidden:i,hideOverflow:!0,calloutMaxHeight:480,isBeakVisible:!1,preventDismissOnLostFocus:!0,target:{current:t},directionalHint:12,children:(0,y.jsxs)(o.K,{className:Je.calloutContent,onMouseEnter:s,onMouseLeave:s,children:[(0,y.jsx)($e,{children:(0,y.jsx)("h3",{className:Je.moduleDetailTitle,children:l.name})}),(0,y.jsx)($e,{grow:1,shrink:1,className:Je.moduleDetailItemStyle,children:(0,y.jsxs)("div",{children:[(0,y.jsx)(Q._,{title:"Description",className:Je.moduleDetailLabel,children:a("\u63cf\u8ff0")}),(0,y.jsx)("div",{className:Je.moduleDetailBody,children:(0,y.jsx)("p",{children:l.describe})})]})}),(0,y.jsx)($e,{grow:1,shrink:1,className:Je.moduleDetailItemStyle,children:(0,y.jsxs)("div",{children:[(0,y.jsx)(Q._,{title:"Description",className:Je.moduleDetailLabel,children:a("\u521b\u5efa\u4eba")}),(0,y.jsx)("div",{className:Je.moduleDetailBody,children:(0,y.jsx)("p",{children:l.createdBy})})]})}),(0,y.jsx)($e,{grow:1,shrink:1,className:Je.moduleDetailItemStyle,children:(0,y.jsxs)("div",{children:[(0,y.jsx)(Q._,{title:"Description",className:Je.moduleDetailLabel,children:a("\u955c\u50cf")}),(0,y.jsx)("div",{className:Je.moduleDetailBody,children:(0,y.jsx)("p",{children:l.imagesName})})]})}),(0,y.jsx)($e,{grow:1,shrink:1,className:Je.moduleDetailItemStyle,children:(0,y.jsxs)("div",{children:[(0,y.jsx)(Q._,{title:"Description",className:Je.moduleDetailLabel,children:a("\u4e0a\u6b21\u4fee\u6539\u65f6\u95f4")}),(0,y.jsx)("div",{className:Je.moduleDetailBody,children:(0,y.jsx)("p",{children:l.lastChanged})})]})}),(0,y.jsx)($e,{grow:1,shrink:1,className:Je.moduleDetailItemStyle,children:(0,y.jsxs)("div",{children:[(0,y.jsx)(Q._,{title:"Description",className:Je.moduleDetailLabel,children:a("\u7248\u672c")}),(0,y.jsx)("div",{className:Je.moduleDetailBody,children:(0,y.jsx)("p",{children:l.version})})]})}),null!==l&&void 0!==l&&null!==(e=l.expand)&&void 0!==e&&e.help_url?(0,y.jsx)($e,{grow:1,shrink:1,className:Je.moduleButton,children:(0,y.jsx)(c.K,{onClick:function(){window.open(l.expand.help_url)},children:a("\u914d\u7f6e\u6587\u6863")})}):null]})})},Xe={moduleItem:(0,h.y0)({width:"100%",userSelect:"none",cursor:"pointer"}),moduleListModuleCard:(0,h.y0)({margin:"8px 16px",border:"1px solid rgb(234, 234, 234)",background:"rgb(248, 248, 248)",color:"rgb(55, 55, 55)",borderRadius:"2px",padding:"8px",display:"flex",fontSize:"12px",flexDirection:"column","&:hover":{backgroundColor:"#eee"},"> div":{pointerEvents:"none",display:"flex",flexDirection:"row",flexGrow:1,alignItems:"center","> header":{flexGrow:1,color:"rgb(0, 0, 0)",fontWeight:600,fontSize:"12px",textOverflow:"ellipsis",overflow:"hidden",whiteSpace:"nowrap",lineHeight:"16px"},"> summary":{flexGrow:1,color:"rgb(55, 55, 55)",fontSize:"12px"}}})},qe=function(e){var n=(0,x.T)(),i=(0,t.useState)(e.model),o=(0,l.Z)(i,2),r=o[0],s=o[1],d=function(e){"mouseenter"===e.type&&n((0,He.VF)(e.target)),n((0,He.DH)("mouseenter"!==e.type)),n((0,He.rn)(r))};return(0,t.useEffect)((function(){s(e.model)}),[e.model]),(0,y.jsx)("div",{className:Xe.moduleItem,children:(0,y.jsx)("div",{className:"module-card-with-hover-wrap",children:(0,y.jsx)("div",{className:"module-card-content-wrap",children:(0,y.jsxs)("div",{className:Xe.moduleListModuleCard,onMouseEnter:d,onMouseLeave:d,onMouseDown:function(){n((0,He.DH)(!0))},onDragStart:function(e){e.dataTransfer.setData("application/reactflow",JSON.stringify(r)),e.dataTransfer.effectAllowed="move"},draggable:!0,children:[(0,y.jsxs)("div",{children:[(0,y.jsx)(a.J,{iconName:"Database",styles:{root:{marginRight:"4px",lineHeight:"16px"}}}),(0,y.jsx)("header",{children:r.name})]}),(0,y.jsx)("div",{children:(0,y.jsx)("summary",{children:(0,y.jsx)("span",{children:r.describe})})})]})})})})},Ve={moduleItem:(0,h.y0)({width:"100%",userSelect:"none",cursor:"pointer"}),moduleListModuleCard:(0,h.y0)({margin:"4px 8px",border:"1px solid rgb(234, 234, 234)",background:"rgb(248, 248, 248)",color:"rgb(55, 55, 55)",borderRadius:"2px",padding:"5px 8px",display:"flex",fontSize:"12px",flexDirection:"column","&:hover":{backgroundColor:"#eee"},"> div":{pointerEvents:"none",display:"flex",flexDirection:"row",flexGrow:1,alignItems:"center","> header":{flexGrow:1,color:"rgb(0, 0, 0)",fontWeight:600,fontSize:"12px",textOverflow:"ellipsis",overflow:"hidden",whiteSpace:"nowrap",lineHeight:"16px"},"> summary":{flexGrow:1,color:"rgb(55, 55, 55)",fontSize:"12px"}}})},Ye=function(e){var n=(0,t.useState)(e.model),i=(0,l.Z)(n,2),o=i[0],r=i[1];return(0,t.useEffect)((function(){r(e.model)}),[e.model]),(0,y.jsx)("div",{className:Ve.moduleItem,children:(0,y.jsx)("div",{className:"module-card-with-hover-wrap",children:(0,y.jsx)("div",{className:"module-card-content-wrap",children:(0,y.jsxs)("div",{className:Ve.moduleListModuleCard,onClick:e.onClick,children:[(0,y.jsxs)("div",{children:[(0,y.jsx)(a.J,{iconName:"Database",styles:{root:{marginRight:"4px",lineHeight:"16px"}}}),(0,y.jsx)("header",{children:o.name})]}),(0,y.jsx)("div",{children:(0,y.jsx)("summary",{children:(0,y.jsx)("span",{children:o.describe})})})]})})})})},Qe={"::-webkit-scrollbar":{width:4},"::-webkit-scrollbar-thumb":{minHeight:"15px",border:"6px solid transparent",backgroundClip:"padding-box",backgroundColor:"rgb(200, 200, 200)"}},en={showModuleTree:(0,h.y0)({width:"320px",height:"100%",transition:"all 0.35s ease 0s",overflowX:"hidden",visibility:"visible"}),hideModuleTree:(0,h.y0)({width:"0px",height:"100%",transition:"width 0.35s ease 0s",overflowX:"hidden",visibility:"hidden"}),treeContainer:(0,h.y0)({width:"320px",boxSizing:"border-box",height:"100%",display:"flex",flexDirection:"column",borderRight:"1px solid rgb(234, 234, 234)",backgroundColor:"#fff"}),searchBoxStyle:(0,h.y0)({margin:"12px 16px",padding:"1px 0px",color:"rgb(1, 92, 218)",lineHeight:"32px",minHeight:"32px",flexGrow:"1"}),searchCallout:(0,h.y0)({".ms-Callout-main":(0,I.Z)({overflowY:"overlay",willChange:"transform"},Qe)}),searchListStyle:(0,h.y0)({width:"287px",padding:"8px 0"}),summaryStyle:(0,h.y0)({display:"flex",justifyContent:"space-between",alignItems:"center",padding:"8px 16px",borderTop:"1px solid rgb(218, 218, 218)"}),moduleTreeStyle:(0,h.y0)({position:"relative",display:"flex",flexDirection:"column",overflowX:"hidden",overflowY:"auto",flexGrow:"1"}),moduleTreeBody:(0,h.y0)({position:"relative",height:"100%"}),listIconStyle:(0,h.y0)({display:"inline-flex",fontSize:"12px",lineHeight:"12px",marginRight:"4px",height:"6px",color:"rgb(55, 55, 55)",userSelect:"none"}),spinnerContainer:(0,h.y0)({width:"100%",height:"100%",display:"flex",justifyContent:"center",alignItems:"center"}),moduleListStyle:(0,h.y0)((0,I.Z)({padding:0,margin:"0 auto",overflowY:"overlay",height:"100%",willChange:"transform"},Qe)),moduleListItem:(0,h.y0)({listStyle:"none",outline:"none"}),itemFolderNode:(0,h.y0)({display:"flex",alignItems:"center",cursor:"pointer",padding:"7px 15px",border:"1px solid transparent",fontFamily:"Segoe UI,sans-serif",fontSize:12,lineHeight:16,fontWeight:600,color:"black","&:hover":{backgroundColor:"#eaeaea"}})},nn=o.K.Item,tn=[{color:"rgba(0,120,212,1)",bg:"rgba(0,120,212,0.02)"},{color:"rgba(0,170,200,1)",bg:"rgba(0,170,200,0.02)"},{color:"rgba(0,200,153,1)",bg:"rgba(0,200,153,0.02)"},{color:"rgba(0,6,200,1)",bg:"rgba(0,6,200,0.02)"},{color:"rgba(212,65,0,1)",bg:"rgba(212,65,0,0.02)"},{color:"rgba(212,176,0,1)",bg:"rgba(212,176,0,0.02)"}],on=function(){var e=(0,x.T)(),n=(0,x.C)(He.RU),i=(0,t.useState)(new Set),s=(0,l.Z)(i,2),d=s[0],c=s[1],u=(0,t.useState)(new Map),p=(0,l.Z)(u,2),m=p[0],h=p[1],g=(0,t.useState)(0),b=(0,l.Z)(g,2),j=b[0],w=b[1],C=(0,t.useState)(!1),N=(0,l.Z)(C,2),Z=N[0],D=N[1],T=(0,t.useState)(!1),I=(0,l.Z)(T,2),O=I[0],B=I[1],z=(0,t.useState)(new Map),H=(0,l.Z)(z,2),M=H[0],W=H[1],E=(0,v.$G)(),F=E.t,R=(E.i18n,function(e){var n=new Map,i=0;e.forEach((function(e){if("Release"===e.version){i+=1;var t={id:e.id,args:e.args?JSON.parse(e.args):{},name:e.name,version:e.version,describe:e.describe,imagesName:e.images.name,createdBy:e.created_by.username,lastChanged:e.changed_on,expand:JSON.parse(e.expand),color:tn[e.project.id%tn.length]};n.has(e.project.id)?n.get(e.project.id).children.push(t):n.set(e.project.id,{id:e.project.id,title:e.project.name,children:[t]})}})),w(i),h(n)}),P=function(){D(!0),w(0),_.Z.job_template_modelview().then((function(e){if(0===(null===e||void 0===e?void 0:e.status)&&"success"===(null===e||void 0===e?void 0:e.message)){R(null===e||void 0===e?void 0:e.result.data);var n=Date.now();Se.set("job_template",{update:n,value:null===e||void 0===e?void 0:e.result.data,expire:864e5})}})).catch((function(n){var i,t;n.response&&e((0,L.L$)({msg:null===(i=n.response)||void 0===i||null===(t=i.data)||void 0===t?void 0:t.message}))})).finally((function(){D(!1)}))};return(0,t.useEffect)((function(){var e=Se.get("job_template");e&&Date.now()-(null===e||void 0===e?void 0:e.update)<(null===e||void 0===e?void 0:e.expire)?R(e.value):P()}),[]),(0,y.jsxs)(nn,{shrink:!0,children:[(0,y.jsx)("div",{className:n?en.showModuleTree:en.hideModuleTree,children:(0,y.jsxs)("div",{className:en.treeContainer,children:[(0,y.jsxs)(o.K,{horizontal:!0,horizontalAlign:"space-between",children:[(0,y.jsx)(Pe.R,{placeholder:F("\u641c\u7d22\u6a21\u677f\u540d\u79f0\u6216\u63cf\u8ff0"),role:"search",className:en.searchBoxStyle,onChange:f((function(e,n){if(n){console.log(n);var i=new Map;m.forEach((function(e,t){var o=e.children;o.length>0&&o.forEach((function(e){var o,l;((null===e||void 0===e||null===(o=e.name)||void 0===o?void 0:o.indexOf(n))>-1||(null===e||void 0===e||null===(l=e.describe)||void 0===l?void 0:l.indexOf(n))>-1)&&(i.has(t)?i.set(t,i.get(t).concat(e)):i.set(t,[e]))}))})),W(i),B(!0)}else B(!1)}),300),onBlur:function(){setTimeout((function(){B(!1)}),300)}}),(0,y.jsx)(Ke.U,{className:en.searchCallout,isBeakVisible:!1,preventDismissOnLostFocus:!0,hidden:!O,calloutMaxHeight:300,target:".ms-SearchBox",children:(0,y.jsxs)(o.K,{className:en.searchListStyle,children:[0===Array.from(M.keys()).length?(0,y.jsx)("div",{style:{textAlign:"center"},children:F("\u6682\u65e0\u5339\u914d")}):"",Array.from(M.keys()).map((function(e){var n=M.get(e);return(0,y.jsx)(t.Fragment,{children:null===n||void 0===n?void 0:n.map((function(n){return(0,y.jsx)(Ye,{model:n,onClick:function(){console.log(d),d.has(e)||(d.add(e),c(new Set(d)))}},n.id)}))},e)}))]})})]}),(0,y.jsxs)("div",{className:en.summaryStyle,children:[(0,y.jsxs)(Ge.x,{children:[j," assets in total"]}),(0,y.jsxs)(Ae.k,{children:[(0,y.jsx)(r.h,{iconProps:{iconName:"Refresh"},onClick:function(){Z||P()}}),(0,y.jsx)(r.h,{iconProps:{iconName:"Add"},onClick:function(){window.open("/frontend/train/train_template/job_template?isVisableAdd=true")}})]})]}),(0,y.jsx)("div",{className:en.moduleTreeStyle,children:(0,y.jsx)("div",{className:en.moduleTreeBody,children:Z?(0,y.jsx)(o.K,{className:en.spinnerContainer,children:(0,y.jsx)(S.$,{size:k.E.large,label:"Loading"})}):(0,y.jsx)("ul",{className:en.moduleListStyle,children:Array.from(m.keys()).map((function(e){var n,i=m.get(e);return(0,y.jsxs)("li",{className:en.moduleListItem,children:[(0,y.jsx)("div",{role:"button",onClick:function(){d.has(e)?d.delete(e):d.add(e),c(new Set(d))},children:(0,y.jsxs)("div",{className:en.itemFolderNode,children:[(0,y.jsx)(a.J,{iconName:d.has(e)?"FlickUp":"FlickLeft",styles:{root:{alignItems:d.has(e)?"baseline":"center"}},className:en.listIconStyle}),i.title]})}),d.has(e)?(0,y.jsx)("ul",{role:"group",style:{paddingLeft:"0px"},children:null===(n=i.children)||void 0===n?void 0:n.map((function(e){return(0,y.jsx)("li",{className:en.moduleListItem,children:(0,y.jsx)("div",{role:"button",children:(0,y.jsx)(qe,{model:e})})},e.id)}))}):null]},e)}))})})})]})}),(0,y.jsx)(Ue,{})]})},ln={root:{width:"100%",height:"100%",overflow:"hidden"}},rn=function(){return(0,y.jsxs)(o.K,{className:"app-container",horizontal:!0,styles:ln,children:[(0,y.jsx)(on,{}),(0,y.jsx)(Re,{}),(0,y.jsx)(b,{})]})}}}]);